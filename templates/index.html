<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Cisco Network Management Dashboard</title>
  <!-- vis-network CDN -->
  <script type="text/javascript" src="https://unpkg.com/vis-network@9.1.2/dist/vis-network.min.js"></script>
  <link rel="stylesheet" href="https://unpkg.com/vis-network@9.1.2/dist/vis-network.min.css"/>
  <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>
  <div class="header">
    <h1>üåê Cisco Network Management Dashboard</h1>
    <p>Intelligent Topology Discovery ‚Ä¢ Real-time Health Monitoring ‚Ä¢ Configuration Management</p>
  </div>

  <div class="dashboard">
    <!-- Main Panel -->
    <div class="main-panel">
      <!-- Network Topology Card -->
      <div class="card">
        <div class="card-header">
          <h3 class="card-title">üèóÔ∏è Network Topology</h3>
          <div class="control-panel">
            <!-- Add this before the Quick Scan button -->
<div class="form-group" style="margin-bottom: 10px;">
    <label class="form-label">Quick Scan Network</label>
    <input type="text" class="form-input" id="quickScanRange" 
           placeholder="Auto-detect or enter range" value="">
    <div style="font-size: 11px; color: #9ca3af; margin-top: 2px;">
        Leave empty to auto-detect, or enter: 192.168.1.0/24, 10.0.0.0/24, etc.
    </div>
</div>
            <button class="btn btn-success" id="quickScanBtn">‚ö° Quick Scan</button>
            <button class="btn" id="scanBtn">üîç Full Scan</button>
            <button class="btn btn-secondary" id="validateBtn">‚úÖ Validate</button>
            <button class="btn btn-secondary" id="refreshBtn">üîÑ Refresh</button>
            <button class="btn btn-secondary" id="exportBtn">üì§ Export</button>
          </div>
        </div>
        <div class="card-content">
          <div class="legend">
            <div class="legend-item">
              <div class="legend-dot core"></div>
              <span>Core (1 expected)</span>
            </div>
            <div class="legend-item">
              <div class="legend-dot distribution"></div>
              <span>Distribution (2 expected)</span>
            </div>
            <div class="legend-item">
              <div class="legend-dot access"></div>
              <span>Access (4 expected)</span>
            </div>
          </div>
          
          <!-- Topology Status Banner -->
          <div id="topologyStatus" class="topology-status" style="display: none;">
            <div class="status-content">
              <div class="status-icon">‚úÖ</div>
              <div class="status-text">
                <div class="status-title">Topology Status</div>
                <div class="status-details">All devices accessible</div>
              </div>
              <div class="status-stats">7/7</div>
            </div>
          </div>
          
          <div id="network-topology" class="network-topology"></div>
        </div>
      </div>
    </div>

    <!-- Sidebar -->
    <div class="sidebar">
      <!-- Device Details Card -->
      <div class="card">
        <div class="card-header">
          <h3 class="card-title">üîß Device Details</h3>
        </div>
        <div class="card-content">
          <div class="switch-details" id="switchDetails">
            <div class="switch-name" id="switchName">Select a device</div>
            <div class="switch-info" id="switchInfo">
              <div class="info-row">
                <span class="info-label">Role:</span>
                <span class="info-value" id="switchRole">‚Äî</span>
              </div>
              <div class="info-row">
                <span class="info-label">IP:</span>
                <span class="info-value" id="switchIP">‚Äî</span>
              </div>
              <div class="info-row">
                <span class="info-label">Model:</span>
                <span class="info-value" id="switchModel">‚Äî</span>
              </div>
              <div class="info-row">
                <span class="info-label">IOS Version:</span>
                <span class="info-value" id="switchIOS">‚Äî</span>
              </div>
              <div class="info-row">
                <span class="info-label">Status:</span>
                <div class="status-indicator status-healthy" id="switchStatus">
                  <div class="status-dot"></div>
                  <span>‚Äî</span>
                </div>
              </div>
            </div>
            
            <div class="health-metrics" id="healthMetrics">
              <div class="metric">
                <div class="metric-value" id="interfacesValue">‚Äî</div>
                <div class="metric-label">Interfaces</div>
              </div>
              <div class="metric">
                <div class="metric-value" id="uptimeValue">‚Äî</div>
                <div class="metric-label">Uptime</div>
              </div>
              <div class="metric">
                <div class="metric-value" id="portsValue">‚Äî</div>
                <div class="metric-label">Open Ports</div>
              </div>
              <div class="metric">
                <div class="metric-value" id="priorityValue">‚Äî</div>
                <div class="metric-label">Priority</div>
              </div>
            </div>

            <div style="margin-top: 15px; display: flex; gap: 8px; flex-wrap: wrap;">
              <button class="btn btn-success" id="backupBtn">üíæ Backup</button>
              <button class="btn" id="testConnBtn">üîó Test</button>
              <button class="btn btn-secondary" id="configBtn">‚öôÔ∏è Configure</button>
            </div>
          </div>
        </div>
      </div>

      <!-- Enhanced Network Scanner Card -->
      <div class="card">
        <div class="card-header">
          <h3 class="card-title">üîç Smart Scanner</h3>
        </div>
        <div class="card-content">
          <div class="form-group">
            <label class="form-label">Scan Type</label>
            <select class="form-select" id="scanTypeSelector">
              <option value="known_cisco">‚ö° Quick Scan (7 Known Cisco IPs)</option>
              <option value="full">üîç Full Network Scan</option>
              <option value="single">üéØ Single Device</option>
            </select>
            <div class="scan-type-help" id="scanTypeHelp" style="font-size: 11px; color: #9ca3af; margin-top: 4px;">
              Recommended: Quick scan for your 7 Cisco devices (10.10.20.3-13)
            </div>
          </div>
          
          <div class="form-group">
            <label class="form-label" id="rangeLabel">Network Range / Device IP</label>
            <input type="text" class="form-input" id="networkRange" placeholder="10.10.20.0/24" value="10.10.20.0/24">
            <div class="range-suggestions" id="rangeSuggestions" style="font-size: 11px; color: #60a5fa; margin-top: 4px;">
              Known IPs: 10.10.20.3 (Core1), 10.10.20.4-5 (Dist1-2), 10.10.20.10-13 (End1-4)
            </div>
          </div>
          
          <div style="display: flex; gap: 8px; margin-bottom: 12px;">
            <button class="btn" id="scanNetworkBtn" style="flex: 1;">‚ö° Quick Scan Cisco Devices</button>
            <button class="btn btn-secondary" id="validateTopologyBtn">‚úÖ Validate</button>
          </div>
          
          <!-- Scan Progress -->
          <div class="scan-progress" id="scanProgress" style="display: none;">
            <div class="progress-bar">
              <div class="progress-fill" id="progressFill"></div>
            </div>
            <div class="progress-text" id="progressText">Initializing scan...</div>
          </div>
          
          <div class="scan-results" id="scanResults" style="display: none;"></div>
        </div>
      </div>

      <!-- Add/Update Device Card -->
      <div class="card">
        <div class="card-header">
          <h3 class="card-title">‚ûï Add/Update Device</h3>
        </div>
        <div class="card-content">
          <form id="addSwitchForm">
            <div class="form-group">
              <label class="form-label">Hostname</label>
              <input type="text" class="form-input" id="newHostname" placeholder="e.g., Core1, Dist1, End1" required>
              <div style="font-size: 11px; color: #9ca3af; margin-top: 2px;">
                Expected: Core1, Dist1, Dist2, End1-4
              </div>
            </div>
            <div class="form-group">
              <label class="form-label">IP Address</label>
              <input type="text" class="form-input" id="newIP" placeholder="e.g., 10.10.20.3" required>
              <div class="ip-validation" id="ipValidation" style="font-size: 11px; margin-top: 2px;"></div>
            </div>
            <div class="form-group">
              <label class="form-label">Role</label>
              <select class="form-select" id="newRole">
                <option value="core">üèõÔ∏è Core Switch</option>
                <option value="distribution">üè¢ Distribution Switch</option>
                <option value="access" selected>üè† Access Switch</option>
              </select>
            </div>
            <div class="form-group">
              <label class="form-label">Device Type</label>
              <select class="form-select" id="newDeviceType">
                <option value="cisco" selected>üîµ Cisco IOS</option>
                <option value="ovs">üü† Open vSwitch</option>
                <option value="linux">üü¢ Linux Device</option>
              </select>
            </div>
            <div style="display: flex; gap: 8px;">
              <button type="submit" class="btn" style="flex: 1;">‚ûï Add/Update</button>
              <button type="button" class="btn btn-danger" id="deleteBtn">üóëÔ∏è Delete</button>
            </div>
          </form>
        </div>
      </div>

      <!-- Activity Log Card -->
      <div class="card">
        <div class="card-header">
          <h3 class="card-title">üìã Activity Log</h3>
          <div style="display: flex; gap: 6px;">
            <button class="btn btn-secondary" id="clearLogBtn" style="font-size: 11px; padding: 4px 8px;">Clear</button>
            <button class="btn btn-secondary" id="refreshLogBtn" style="font-size: 11px; padding: 4px 8px;">Refresh</button>
          </div>
        </div>
        <div class="card-content">
          <div class="log-panel" id="activityLog">
            <div class="log-entry">[INIT] üöÄ Cisco Network Dashboard initialized</div>
            <div class="log-entry">[INFO] üì° Ready to discover and manage Cisco devices</div>
            <div class="log-entry">[TIP] üí° Use Quick Scan for your 7 known Cisco IPs (fastest)</div>
            <div class="log-entry">[TIP] ‚ö° Keyboard shortcuts: Ctrl+Q (Quick Scan), Ctrl+T (Validate)</div>
          </div>
        </div>
      </div>

      <!-- Quick Stats Card -->
      <div class="card">
        <div class="card-header">
          <h3 class="card-title">üìä Network Stats</h3>
        </div>
        <div class="card-content">
          <div class="stats-grid">
            <div class="stat-item">
              <div class="stat-value" id="totalDevices">0</div>
              <div class="stat-label">Total Devices</div>
            </div>
            <div class="stat-item">
              <div class="stat-value" id="onlineDevices">0</div>
              <div class="stat-label">Online</div>
            </div>
            <div class="stat-item">
              <div class="stat-value" id="offlineDevices">0</div>
              <div class="stat-label">Offline</div>
            </div>
            <div class="stat-item">
              <div class="stat-value" id="lastScanTime">Never</div>
              <div class="stat-label">Last Scan</div>
            </div>
          </div>
          
          <div class="topology-health" id="topologyHealth" style="margin-top: 12px;">
            <div class="health-indicator">
              <div class="health-status unknown" id="healthStatus">
                <div class="health-dot"></div>
                <span>Unknown</span>
              </div>
              <div class="health-score" id="healthScore">‚Äî</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Enhanced CSS for new components -->
  <style>
    .topology-status {
      background: linear-gradient(135deg, rgba(34, 197, 94, 0.1) 0%, rgba(16, 185, 129, 0.1) 100%);
      border: 1px solid rgba(34, 197, 94, 0.3);
      border-radius: 8px;
      padding: 12px;
      margin-bottom: 16px;
      transition: all 0.3s ease;
    }

    .topology-status.warning {
      background: linear-gradient(135deg, rgba(245, 158, 11, 0.1) 0%, rgba(217, 119, 6, 0.1) 100%);
      border-color: rgba(245, 158, 11, 0.3);
    }

    .topology-status.critical {
      background: linear-gradient(135deg, rgba(239, 68, 68, 0.1) 0%, rgba(220, 38, 38, 0.1) 100%);
      border-color: rgba(239, 68, 68, 0.3);
    }

    .status-content {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .status-icon {
      font-size: 20px;
    }

    .status-text {
      flex: 1;
    }

    .status-title {
      font-weight: 600;
      font-size: 14px;
      color: #e2e8f0;
    }

    .status-details {
      font-size: 12px;
      color: #94a3b8;
      margin-top: 2px;
    }

    .status-stats {
      font-size: 18px;
      font-weight: 700;
      color: #34d399;
    }

    .scan-progress {
      margin: 12px 0;
    }

    .progress-bar {
      width: 100%;
      height: 6px;
      background: rgba(71, 85, 105, 0.3);
      border-radius: 3px;
      overflow: hidden;
      margin-bottom: 8px;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, #3b82f6, #60a5fa);
      width: 0%;
      transition: width 0.3s ease;
      border-radius: 3px;
    }

    .progress-text {
      font-size: 12px;
      color: #94a3b8;
      text-align: center;
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 12px;
      margin-bottom: 16px;
    }

    .stat-item {
      text-align: center;
      padding: 12px;
      background: rgba(15, 23, 42, 0.5);
      border-radius: 8px;
      border: 1px solid rgba(71, 85, 105, 0.3);
    }

    .stat-value {
      font-size: 18px;
      font-weight: 700;
      color: #60a5fa;
      margin-bottom: 4px;
    }

    .stat-label {
      font-size: 11px;
      color: #94a3b8;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .health-indicator {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 12px;
      background: rgba(15, 23, 42, 0.5);
      border-radius: 6px;
      border: 1px solid rgba(71, 85, 105, 0.3);
    }

    .health-status {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 13px;
      font-weight: 500;
    }

    .health-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: #6b7280;
    }

    .health-status.healthy .health-dot { background: #34d399; }
    .health-status.warning .health-dot { background: #fbbf24; }
    .health-status.critical .health-dot { background: #ef4444; }
    .health-status.unknown .health-dot { background: #6b7280; }

    .health-score {
      font-size: 14px;
      font-weight: 600;
      color: #e2e8f0;
    }

    .scan-type-help, .range-suggestions {
      transition: color 0.2s ease;
    }

    .ip-validation {
      color: #10b981;
    }

    .ip-validation.invalid {
      color: #ef4444;
    }

    .log-entry {
      margin-bottom: 2px;
      line-height: 1.4;
    }

    /* Animation for scan progress */
    @keyframes scan-pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.6; }
    }

    .scanning .progress-fill {
      animation: scan-pulse 1.5s ease-in-out infinite;
    }

    /* Responsive improvements */
    @media (max-width: 768px) {
      .control-panel {
        flex-wrap: wrap;
        justify-content: center;
        gap: 6px;
      }
      
      .stats-grid {
        grid-template-columns: repeat(4, 1fr);
        gap: 8px;
      }
      
      .stat-value {
        font-size: 16px;
      }
      
      .status-content {
        flex-direction: column;
        text-align: center;
        gap: 8px;
      }
    }
  </style>

  <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>